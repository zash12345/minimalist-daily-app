<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Minimal Journal App</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Lucide -->
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="bg-neutral-50">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef } = React;

    function Icon({ name, size = 18 }) {
      const ref = React.useRef();
      React.useEffect(() => {
        if (ref.current) lucide.createIcons();
      });
      return <i ref={ref} data-lucide={name} width={size} height={size}></i>;
    }

    function App() {
      const [view, setView] = useState('journal');
      const [selectedDate, setSelectedDate] = useState(new Date());
      const [habitMonthView, setHabitMonthView] = useState(new Date());
      const [entries, setEntries] = useState({});
      const [habits, setHabits] = useState([
        { id: 1, name: 'Morning meditation', completed: {} },
        { id: 2, name: 'Exercise', completed: {} },
        { id: 3, name: 'Read', completed: {} }
      ]);
      const [newHabit, setNewHabit] = useState('');
      const [showAddHabit, setShowAddHabit] = useState(false);
      const [fontSize, setFontSize] = useState(14);

      const dateKey = selectedDate.toISOString().split('T')[0];
      const currentEntry = entries[dateKey] || '';

      const handleEntryChange = (html) => {
        setEntries({ ...entries, [dateKey]: html });
      };

      const changeDate = (d) => {
        const n = new Date(selectedDate);
        n.setDate(n.getDate() + d);
        setSelectedDate(n);
      };

      const changeMonth = (d) => {
        const n = new Date(selectedDate);
        n.setMonth(n.getMonth() + d);
        setSelectedDate(n);
      };

      const increaseFont = () => setFontSize(v => Math.min(v + 2, 24));
      const decreaseFont = () => setFontSize(v => Math.max(v - 2, 10));

      const bold = () => document.execCommand('bold');
      const bullet = () => document.execCommand('insertUnorderedList');

      return (
        <div className="min-h-screen p-6 max-w-6xl mx-auto">
          <div className="flex justify-between mb-6">
            <h1 className="text-2xl font-light">{new Date().getFullYear()}</h1>
            <div className="flex gap-2">
              {['journal','habits','calendar'].map(v => (
                <button
                  key={v}
                  onClick={() => setView(v)}
                  className={`px-4 py-2 rounded-lg ${
                    view === v ? 'bg-neutral-900 text-white' : 'bg-white hover:bg-neutral-100'
                  }`}
                >
                  {v[0].toUpperCase() + v.slice(1)}
                </button>
              ))}
            </div>
          </div>

          {view === 'journal' && (
            <div className="bg-white p-6 rounded-xl shadow-sm">
              <div
                contentEditable
                onInput={e => handleEntryChange(e.currentTarget.innerHTML)}
                dangerouslySetInnerHTML={{ __html: currentEntry }}
                className="border rounded-xl p-4 h-64 outline-none"
                style={{ fontSize }}
              />
              <div className="flex gap-2 mt-4">
                <button onClick={decreaseFont} className="border px-3 py-1">A-</button>
                <button onClick={increaseFont} className="border px-3 py-1">A+</button>
                <button onClick={bold} className="border p-2"><Icon name="bold"/></button>
                <button onClick={bullet} className="border p-2"><Icon name="list"/></button>
              </div>
            </div>
          )}

          {view === 'calendar' && (
            <div className="bg-white p-6 rounded-xl shadow-sm">
              <div className="flex justify-between mb-4">
                <button onClick={() => changeMonth(-1)}><Icon name="chevron-left"/></button>
                <h2>{selectedDate.toLocaleDateString('en-US',{month:'long',year:'numeric'})}</h2>
                <button onClick={() => changeMonth(1)}><Icon name="chevron-right"/></button>
              </div>
            </div>
          )}

          {view === 'habits' && (
            <div className="bg-white p-6 rounded-xl shadow-sm">
              <h2 className="text-lg mb-4">Habits</h2>
              {habits.map(h => (
                <div key={h.id} className="border p-3 rounded mb-2">
                  {h.name}
                </div>
              ))}
            </div>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
